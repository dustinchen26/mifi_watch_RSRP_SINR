<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>數據解析器</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    textarea {
      width: 100%;
      height: 300px;
      font-size: 16px;
      margin-bottom: 10px;
    }
    button {
      padding: 10px;
      font-size: 16px;
    }
    .result {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #ccc;
      background-color: #f9f9f9;
    }
  </style>
</head>
<body>

<h1>數據解析器</h1>
<textarea id="inputText" placeholder="請在此處輸入數據..."></textarea><br>
<button onclick="parseData()">解析數據</button>

<div id="output" class="result"></div>

<script>
  function parseData() {
    const inputText = document.getElementById('inputText').value.trim();
    const lines = inputText.split('\n').filter(line => line.trim() !== '');

    let output = '';
    let time1 = '';
    let rsrpAndSinr = '';
    let rxData = { rx0: '', rx1: '', rx2: '', rx3: '' };

    for (let i = 0; i < lines.length; i++) {
      const line = lines[i].trim();

      // 解析時間格式 (例如：2024-11-24 08:04:12)
      const timeMatch = line.match(/(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})/);
      if (timeMatch) {
        time1 = timeMatch[1];
      }

      // 解析 RSRP 和 SINR (例如：RSRQ -11 dB, RSRP -78 dBm, SINR 32 dB)
      const rsrpSinrMatch = line.match(/RSRQ\s*(-?\d+)\s*dB,\s*RSRP\s*(-?\d+)\s*dBm,\s*SINR\s*(-?\d+)\s*dB/);
      if (rsrpSinrMatch) {
        rsrpAndSinr = `RSRP ${rsrpSinrMatch[2]} dBm, SINR ${rsrpSinrMatch[3]} dB`;
      }

      // 解析 RX0 到 RX3 的數據
      const rxMatch = line.match(/(RX[0-3])\s*power:\s*(-?\d+)\s*dBm,.*rsrp:\s*(-?\d+)\s*dBm/);
      if (rxMatch) {
        const rxIndex = rxMatch[1].toLowerCase(); // RX0, RX1, RX2, RX3
        const rsrpValue = rxMatch[3];
        if (rxIndex === 'rx0') {
          rxData.rx0 = `RX0 rsrp: ${rsrpValue} dBm`;
        } else if (rxIndex === 'rx1') {
          rxData.rx1 = `RX1 rsrp: ${rsrpValue} dBm`;
        } else if (rxIndex === 'rx2') {
          rxData.rx2 = `RX2 rsrp: ${rsrpValue} dBm`;
        } else if (rxIndex === 'rx3') {
          rxData.rx3 = `RX3 rsrp: ${rsrpValue} dBm`;
        }
      }

      // 每次處理完一行後，如果我們已經有所有的數據，組裝並顯示
      if (time1 && rsrpAndSinr && rxData.rx0 && rxData.rx1 && rxData.rx2 && rxData.rx3) {
        output += `<p>time = ${time1}, ${rsrpAndSinr}, ${rxData.rx0}, ${rxData.rx1}, ${rxData.rx2}, ${rxData.rx3}</p>`;
        // 重置數據以便處理下一組數據
        time1 = rsrpAndSinr = '';
        rxData = { rx0: '', rx1: '', rx2: '', rx3: '' };
      }
    }

    // 顯示結果
    document.getElementById('output').innerHTML = output || '<p>未能解析出任何有效數據。</p>';
  }
</script>

</body>
</html>
